## Useful Scripts
Several useful scripts are provided in `./scripts`.

### Requirements of the scripts
```
python >= 3.10
tqdm
numpy
json
pandas
shutil
concurrent.futures
datetime
```

### Evaluation config

Before fuzzing compilers using our scripts, an evaluation config is required. The config includes information about compiler under test, compiler flags, emulator, and emulator flags.

An example of config is shown in `scripts/config_example.txt`.
Evaluation configs are parsed by `scripts/Config.py`.

### Driver of RVISmith
The driver generates programs with **n** seeds and fuzzing with the given config in parallel. Driver code is in `scripts/RVISmithDriver.py`.

Usage:
```
python3 scripts/RVISmithDriver.py -h
usage: RVISmithDriver.py [-h] [-n NUMBER] -r RVISMITH_PATH -c CONFIG_PATH [-o OUTPUT_PATH] [--policy] [--overloaded]

options:
  -h, --help            show this help message and exit
  -n NUMBER, --number NUMBER
                        test case number
  -r RVISMITH_PATH, --rvismith_path RVISMITH_PATH
                        path to rvismith
  -c CONFIG_PATH, --config_path CONFIG_PATH
                        evaluation config path
  -o OUTPUT_PATH, --output_path OUTPUT_PATH
                        output path of test cases
  --policy              whether load-store intrinsics with policy suffixes included
  --overloaded          whether overloaded load-store intrinsics included
```

We provide a script in `scripts/Summary.py` to summarize the evaluation after using driver.

Input the `res.csv` (generated by the driver) to `Summary.py`, e.g.:
```
python3 scripts/Summary.py /home/evaluation/500000/gcc-15-20241117/20241226-125750/res.csv
sum: 1500000
success: 99.854%(1497811/1500000)
calculation error: 0.146%(2187/1500000)
emulator dumped: 0.000%(2/1500000)

emi: 0.002%(11/500000)
```

### Generate **n** programs using RVISmith (without evaluation)
Use the script `scripts/TestGen.py`
```
python3 scripts/TestGen.py -h
usage: TestGen.py [-h] -r RVISMITH_PATH -o TESTCODE_PATH [-n NUMBER] [--segment] [--policy] [--overloaded]

options:
  -h, --help            show this help message and exit
  -r RVISMITH_PATH, --rvismith_path RVISMITH_PATH
                        path to rvismith
  -o TESTCODE_PATH, --testcode_path TESTCODE_PATH
                        output path of test cases
  -n NUMBER, --number NUMBER
                        test case number
  --segment             whether segment load-store intrinsics included
  --policy              whether load-store intrinsics with policy suffixes included
  --overloaded          whether overloaded load-store intrinsics included
```


### Intrinsic coverage

#### RVISmith: `scripts/RVISmithCoverage.py`

Set appropriate `rvismith_path` and `mode` in `RVISmithCoverage.py` before use the script:

| Intrinsic                                            | RVISmith                 | Mode |
| ---------------------------------------------------- | ------------------------ | ---- |
| explicit (non-overloaded) intrinsics                 | rvismith-explicit        | 0    |
| explicit (non-overloaded) intrinsics policy variants | rvismith-explicit-policy | 1    |
| implicit (overloaded) intrinsics                     | rvismith-implicit        | 2    |
| implicit (overloaded) intrinsics policy variants     | rvismith-implicit-policy | 3    |

#### RIF: `scripts/RIFCoverage.py`

Set appropriate `rif_random_path`, `rif_fused_path`, `rif_opdef_path`, and `mode` in `RIFCoverage.py` before use the script:


### Performance of RVISmith

Set the `config`, `rvismith_path`, and `get_time()` in `scripts/Performance.py`, and then:
```
python3 scripts/Performance.py -h
usage: Performance.py [-h] [-n NUMBER]

options:
  -h, --help            show this help message and exit
  -n NUMBER, --number NUMBER
                        number of test cases
```
